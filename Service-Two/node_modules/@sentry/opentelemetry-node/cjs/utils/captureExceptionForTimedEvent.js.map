{"version":3,"file":"captureExceptionForTimedEvent.js","sources":["../../../src/utils/captureExceptionForTimedEvent.ts"],"sourcesContent":["import type { Span as OtelSpan, TimedEvent } from '@opentelemetry/sdk-trace-base';\nimport { SemanticAttributes } from '@opentelemetry/semantic-conventions';\nimport type { Hub } from '@sentry/types';\nimport { isString } from '@sentry/utils';\n\n/**\n * Maybe capture a Sentry exception for an OTEL timed event.\n * This will check if the event is exception-like and in that case capture it as an exception.\n */\n// eslint-disable-next-line deprecation/deprecation\nexport function maybeCaptureExceptionForTimedEvent(hub: Hub, event: TimedEvent, otelSpan?: OtelSpan): void {\n  if (event.name !== 'exception') {\n    return;\n  }\n\n  const attributes = event.attributes;\n  if (!attributes) {\n    return;\n  }\n\n  const message = attributes[SemanticAttributes.EXCEPTION_MESSAGE];\n\n  if (typeof message !== 'string') {\n    return;\n  }\n\n  const syntheticError = new Error(message);\n\n  const stack = attributes[SemanticAttributes.EXCEPTION_STACKTRACE];\n  if (isString(stack)) {\n    syntheticError.stack = stack;\n  }\n\n  const type = attributes[SemanticAttributes.EXCEPTION_TYPE];\n  if (isString(type)) {\n    syntheticError.name = type;\n  }\n\n  // eslint-disable-next-line deprecation/deprecation\n  hub.captureException(syntheticError, {\n    captureContext: otelSpan\n      ? {\n          contexts: {\n            otel: {\n              attributes: otelSpan.attributes,\n              resource: otelSpan.resource.attributes,\n            },\n            trace: {\n              trace_id: otelSpan.spanContext().traceId,\n              span_id: otelSpan.spanContext().spanId,\n              parent_span_id: otelSpan.parentSpanId,\n            },\n          },\n        }\n      : undefined,\n  });\n}\n"],"names":["SemanticAttributes","isString"],"mappings":";;;;;AAKA;AACA;AACA;AACA;AACA;AACO,SAAS,kCAAkC,CAAC,GAAG,EAAO,KAAK,EAAc,QAAQ,EAAmB;AAC3G,EAAE,IAAI,KAAK,CAAC,IAAK,KAAI,WAAW,EAAE;AAClC,IAAI,OAAM;AACV,GAAE;AACF;AACA,EAAE,MAAM,UAAA,GAAa,KAAK,CAAC,UAAU,CAAA;AACrC,EAAE,IAAI,CAAC,UAAU,EAAE;AACnB,IAAI,OAAM;AACV,GAAE;AACF;AACA,EAAE,MAAM,UAAU,UAAU,CAACA,sCAAkB,CAAC,iBAAiB,CAAC,CAAA;AAClE;AACA,EAAE,IAAI,OAAO,OAAQ,KAAI,QAAQ,EAAE;AACnC,IAAI,OAAM;AACV,GAAE;AACF;AACA,EAAE,MAAM,cAAe,GAAE,IAAI,KAAK,CAAC,OAAO,CAAC,CAAA;AAC3C;AACA,EAAE,MAAM,QAAQ,UAAU,CAACA,sCAAkB,CAAC,oBAAoB,CAAC,CAAA;AACnE,EAAE,IAAIC,cAAQ,CAAC,KAAK,CAAC,EAAE;AACvB,IAAI,cAAc,CAAC,KAAM,GAAE,KAAK,CAAA;AAChC,GAAE;AACF;AACA,EAAE,MAAM,OAAO,UAAU,CAACD,sCAAkB,CAAC,cAAc,CAAC,CAAA;AAC5D,EAAE,IAAIC,cAAQ,CAAC,IAAI,CAAC,EAAE;AACtB,IAAI,cAAc,CAAC,IAAK,GAAE,IAAI,CAAA;AAC9B,GAAE;AACF;AACA;AACA,EAAE,GAAG,CAAC,gBAAgB,CAAC,cAAc,EAAE;AACvC,IAAI,cAAc,EAAE,QAAA;AACpB,QAAQ;AACR,UAAU,QAAQ,EAAE;AACpB,YAAY,IAAI,EAAE;AAClB,cAAc,UAAU,EAAE,QAAQ,CAAC,UAAU;AAC7C,cAAc,QAAQ,EAAE,QAAQ,CAAC,QAAQ,CAAC,UAAU;AACpD,aAAa;AACb,YAAY,KAAK,EAAE;AACnB,cAAc,QAAQ,EAAE,QAAQ,CAAC,WAAW,EAAE,CAAC,OAAO;AACtD,cAAc,OAAO,EAAE,QAAQ,CAAC,WAAW,EAAE,CAAC,MAAM;AACpD,cAAc,cAAc,EAAE,QAAQ,CAAC,YAAY;AACnD,aAAa;AACb,WAAW;AACX,SAAQ;AACR,QAAQ,SAAS;AACjB,GAAG,CAAC,CAAA;AACJ;;;;"}