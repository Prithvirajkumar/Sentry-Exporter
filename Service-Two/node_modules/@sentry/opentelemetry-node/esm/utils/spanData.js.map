{"version":3,"file":"spanData.js","sources":["../../../src/utils/spanData.ts"],"sourcesContent":["/* eslint-disable deprecation/deprecation */\nimport { Transaction } from '@sentry/core';\nimport type { Context, SpanOrigin } from '@sentry/types';\n\nimport { getSentrySpan } from './spanMap';\n\ntype SentryTags = Record<string, string>;\ntype SentryData = Record<string, unknown>;\ntype Contexts = Record<string, Context>;\n\n/** @deprecated This will be removed in v8. */\nexport interface AdditionalOtelSpanData {\n  data: SentryData;\n  tags: SentryTags;\n  contexts: Contexts;\n  metadata: unknown;\n  origin?: SpanOrigin;\n}\n\nconst OTEL_SPAN_DATA_MAP: Map<string, AdditionalOtelSpanData> = new Map<string, AdditionalOtelSpanData>();\n\n/**\n * Add data that should be added to the sentry span resulting from the given otel span ID.\n * @deprecated This will be removed in v8. This was never meant to be public API.\n */\nexport function addOtelSpanData(\n  otelSpanId: string,\n  { data, tags, contexts, metadata, origin }: Partial<AdditionalOtelSpanData>,\n): void {\n  const sentrySpan = getSentrySpan(otelSpanId);\n  if (!sentrySpan) {\n    return;\n  }\n\n  if (data) {\n    Object.keys(data).forEach(prop => {\n      const value = data[prop];\n      sentrySpan.setData(prop, value);\n    });\n  }\n\n  if (tags) {\n    Object.keys(tags).forEach(prop => {\n      sentrySpan.setTag(prop, tags[prop]);\n    });\n  }\n\n  if (origin) {\n    sentrySpan.origin = origin;\n  }\n\n  if (sentrySpan instanceof Transaction) {\n    if (metadata) {\n      // eslint-disable-next-line deprecation/deprecation\n      sentrySpan.setMetadata(metadata);\n    }\n\n    if (contexts) {\n      Object.keys(contexts).forEach(prop => {\n        sentrySpan.setContext(prop, contexts[prop]);\n      });\n    }\n  }\n}\n\n/**\n * @deprecated This will do nothing and will be removed in v8.\n */\nexport function getOtelSpanData(_otelSpanId: string): AdditionalOtelSpanData {\n  return { data: {}, tags: {}, contexts: {}, metadata: {} };\n}\n\n/**\n * @deprecated This will do nothing and will be removed in v8.\n */\nexport function clearOtelSpanData(otelSpanId: string): void {\n  OTEL_SPAN_DATA_MAP.delete(otelSpanId);\n}\n"],"names":[],"mappings":";;;AAAA;;AAmBA,MAAM,kBAAkB,GAAwC,IAAI,GAAG,EAAkC,CAAA;AACzG;AACA;AACA;AACA;AACA;AACO,SAAS,eAAe;AAC/B,EAAE,UAAU;AACZ,EAAE,EAAE,IAAI,EAAE,IAAI,EAAE,QAAQ,EAAE,QAAQ,EAAE,MAAA,EAAQ;AAC5C,EAAQ;AACR,EAAE,MAAM,UAAW,GAAE,aAAa,CAAC,UAAU,CAAC,CAAA;AAC9C,EAAE,IAAI,CAAC,UAAU,EAAE;AACnB,IAAI,OAAM;AACV,GAAE;AACF;AACA,EAAE,IAAI,IAAI,EAAE;AACZ,IAAI,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,OAAO,CAAC,IAAA,IAAQ;AACtC,MAAM,MAAM,KAAM,GAAE,IAAI,CAAC,IAAI,CAAC,CAAA;AAC9B,MAAM,UAAU,CAAC,OAAO,CAAC,IAAI,EAAE,KAAK,CAAC,CAAA;AACrC,KAAK,CAAC,CAAA;AACN,GAAE;AACF;AACA,EAAE,IAAI,IAAI,EAAE;AACZ,IAAI,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,OAAO,CAAC,IAAA,IAAQ;AACtC,MAAM,UAAU,CAAC,MAAM,CAAC,IAAI,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,CAAA;AACzC,KAAK,CAAC,CAAA;AACN,GAAE;AACF;AACA,EAAE,IAAI,MAAM,EAAE;AACd,IAAI,UAAU,CAAC,MAAO,GAAE,MAAM,CAAA;AAC9B,GAAE;AACF;AACA,EAAE,IAAI,UAAW,YAAW,WAAW,EAAE;AACzC,IAAI,IAAI,QAAQ,EAAE;AAClB;AACA,MAAM,UAAU,CAAC,WAAW,CAAC,QAAQ,CAAC,CAAA;AACtC,KAAI;AACJ;AACA,IAAI,IAAI,QAAQ,EAAE;AAClB,MAAM,MAAM,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,OAAO,CAAC,IAAA,IAAQ;AAC5C,QAAQ,UAAU,CAAC,UAAU,CAAC,IAAI,EAAE,QAAQ,CAAC,IAAI,CAAC,CAAC,CAAA;AACnD,OAAO,CAAC,CAAA;AACR,KAAI;AACJ,GAAE;AACF,CAAA;AACA;AACA;AACA;AACA;AACO,SAAS,eAAe,CAAC,WAAW,EAAkC;AAC7E,EAAE,OAAO,EAAE,IAAI,EAAE,EAAE,EAAE,IAAI,EAAE,EAAE,EAAE,QAAQ,EAAE,EAAE,EAAE,QAAQ,EAAE,EAAC,EAAG,CAAA;AAC3D,CAAA;AACA;AACA;AACA;AACA;AACO,SAAS,iBAAiB,CAAC,UAAU,EAAgB;AAC5D,EAAE,kBAAkB,CAAC,MAAM,CAAC,UAAU,CAAC,CAAA;AACvC;;;;"}